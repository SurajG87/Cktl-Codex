<!DOCTYPE html>
<html lang="en">
<head>
   <!-- Apple Touch Icon (the main one for home screen) -->
<link rel="apple-touch-icon" href="logo.png">

<!-- Optional: Prevents zooming when launching from home screen -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cocktail Codex</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üç∏üêëüç∏</text></svg>">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üç∏üêëüç∏</text></svg>">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Cocktail Codex">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #ffffff;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .page-title {
            font-size: 2rem;
            color: #FFB366;
            margin-bottom: 1rem;
        }
        
        .button {
            background: #FFB366;
            color: #1a1a1a;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }
        
        .button:hover {
            background: #ffa24d;
        }
        
        .button-secondary {
            background: #333;
            color: #fff;
        }
        
        .button-secondary:hover {
            background: #444;
        }
        
        .search-box {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #444;
            border-radius: 8px;
            background: #2a2a2a;
            color: #fff;
            margin-bottom: 1rem;
        }
        
        /* UPDATED: Square recipes grid with minimal spacing - fit 4 cards per line */
        .recipes-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.1cm; /* Reduced from 0.3cm to minimal spacing */
            margin-bottom: 2rem;
        }

        @media (max-width: 1200px) {
            .recipes-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 0.1cm;
            }
        }

        @media (max-width: 1024px) {
            .recipes-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 0.1cm;
            }
        }

        @media (max-width: 768px) {
            .recipes-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.1cm;
            }
        }

        @media (max-width: 480px) {
            .recipes-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.1cm;
            }
        }

        /* UPDATED: Square recipe card with image filling the entire card */
        .recipe-card {
            background: rgba(42, 42, 42, 0.7);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 179, 102, 0.2);
            aspect-ratio: 3/4;
            height: 80px;
            display: flex;
            flex-direction: column;
        }

        .recipe-card:hover {
            transform: translateY(-2px);
            background: rgba(42, 42, 42, 0.9);
        }

        /* UPDATED: Image area to fill the entire card */
        .recipe-image {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            z-index: 0;
        }

        /* UPDATED: Info section positioned at bottom with gradient overlay */
        .recipe-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
            padding: 0.4rem;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        /* UPDATED: Flex container for name and ABV side by side */
        .recipe-name-abv-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        /* UPDATED: Smaller text for compact cards with name and ABV on same line */
        .recipe-name {
            font-weight: 600;
            font-size: 0.65rem;
            color: #FFB366;
            text-align: left;
            line-height: 1.1;
            flex: 1;
            margin-right: 0.5rem;
        }

        .recipe-abv {
            color: #fff;
            font-size: 0.6rem;
            text-align: right;
            white-space: nowrap;
            opacity: 0.9;
            flex-shrink: 0;
        }

        /* Responsive adjustments for smaller cards */
        @media (max-width: 768px) {
            .recipe-card {
                height: 75px;
            }
            
            .recipe-image {
                font-size: 1rem;
            }
            
            .recipe-name {
                font-size: 0.6rem;
            }
            
            .recipe-abv {
                font-size: 0.55rem;
            }
        }

        /* Small mobile devices */
        @media (max-width: 380px) {
            .recipe-card {
                height: 70px;
            }
            
            .recipe-image {
                font-size: 0.9rem;
            }
            
            .recipe-name {
                font-size: 0.55rem;
            }
            
            .recipe-abv {
                font-size: 0.5rem;
            }
            
            .recipe-info {
                padding: 0.3rem;
            }
        }
        
        /* Remove spirit type from card display */
        .recipe-details {
            display: none;
        }
        
        .recipe-spirit {
            display: none;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
            cursor: pointer;
        }
        
        .modal {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            cursor: default;
        }
        
        .modal-title {
            color: #FFB366;
            margin-bottom: 1.5rem;
            text-align: center;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: #FFB366;
        }
        
        .form-input, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #444;
            border-radius: 8px;
            background: #333;
            color: #fff;
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        /* UPDATED: Header layout improvements */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #2a2a2a;
            border-bottom: 1px solid #444;
            gap: 1rem;
        }
        
        .menu-button {
            background: none;
            border: none;
            color: #fff;
            cursor: pointer;
            padding: 0.5rem;
        }
        
        .menu-line {
            display: block;
            width: 20px;
            height: 2px;
            background: #fff;
            margin: 4px 0;
        }
        
        /* Side Menu Styles */
        .side-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .side-menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .side-menu {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100vh;
            background: #2a2a2a;
            z-index: 999;
            transition: left 0.3s;
            padding: 1rem;
        }
        
        .side-menu.active {
            left: 0;
        }
        
        .side-menu-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #444;
        }
        
        .side-menu-logo {
            font-size: 2rem;
            margin-right: 0.5rem;
        }
        
        .side-menu-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .side-menu-nav {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .side-menu-button {
            background: none;
            border: none;
            color: #fff;
            padding: 1rem;
            text-align: left;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .side-menu-button:hover {
            background: #333;
        }
        
        .side-menu-button.active {
            background: #FFB366;
            color: #1a1a1a;
        }
        
        .side-menu-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* UPDATED: Recipe View with name next to back arrow - no table */
        .recipe-view {
            position: relative;
            margin-top: 1rem;
        }
        
        .recipe-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            background-size: cover;
            background-position: center;
            filter: brightness(0.7) blur(0px);
        }
        
        .recipe-content {
            background: rgba(42, 42, 42, 0.85);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(5px);
        }
        
        /* UPDATED: Recipe header with back arrow and name side by side - smaller */
        .recipe-header-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            background: rgba(42, 42, 42, 0.8);
            border-radius: 12px;
            padding: 0.75rem;
        }
        
        .back-arrow {
            background: #333;
            color: #fff;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.2s;
            flex-shrink: 0;
        }
        
        .back-arrow:hover {
            background: #444;
        }
        
        /* UPDATED: Smaller recipe title */
        .recipe-title-header {
            font-size: 1.5rem;
            color: #FFB366;
            margin: 0;
            flex: 1;
            line-height: 1.2;
        }
        
        .recipe-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        
        .meta-item {
            background: #333;
            padding: 0.4rem 0.8rem;
            border-radius: 16px;
            font-size: 0.8rem;
        }
        
        /* UPDATED: Remove table layout, use flex column */
        .recipe-details-page {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .ingredients-list {
            list-style: none;
        }
        
        .ingredient-item {
            display: flex;
            justify-content: space-between;
            padding: 0.4rem 0;
            border-bottom: 1px solid #444;
            font-size: 0.85rem;
        }
        
        .instructions {
            white-space: pre-line;
            line-height: 1.6;
            font-size: 0.85rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
        }
        
        .action-button {
            background: #333;
            color: #fff;
            border: none;
            padding: 0.6rem 0.8rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 0.8rem;
        }
        
        .action-button:hover {
            background: #444;
        }
        
        .action-button.scale {
            background: #4CAF50;
        }
        
        .action-button.share {
            background: #2196F3;
        }
        
        .action-button.edit {
            background: #FF9800;
        }
        
        .action-button.delete {
            background: #f44336;
        }
        
        /* Scale Recipe Styles - Compact */
        .scale-step {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #444;
        }
        
        .step-title {
            color: #FFB366;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .step-description {
            color: #888;
            margin-bottom: 0.8rem;
            font-size: 0.85rem;
        }
        
        .scale-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .option-card {
            background: #333;
            padding: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .option-card:hover {
            background: #3a3a3a;
        }
        
        .option-card.selected {
            border-color: #FFB366;
            background: #3a3a3a;
        }
        
        .option-title {
            font-weight: 600;
            margin-bottom: 0.3rem;
            font-size: 0.95rem;
        }
        
        .option-description {
            color: #888;
            font-size: 0.8rem;
        }
        
        .scale-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .scale-input-group {
            display: flex;
            flex-direction: column;
        }
        
        .scale-input {
            padding: 0.75rem;
            border: 1px solid #444;
            border-radius: 8px;
            background: #333;
            color: #fff;
        }
        
        .dilution-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.8rem;
            margin-bottom: 0.8rem;
        }
        
        .dilution-option {
            background: #333;
            padding: 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .dilution-option:hover {
            background: #3a3a3a;
        }
        
        .dilution-option.selected {
            border-color: #FFB366;
            background: #3a3a3a;
        }
        
        .dilution-percentage {
            font-weight: 600;
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
        }
        
        .dilution-description {
            color: #888;
            font-size: 0.75rem;
        }
        
        .custom-dilution {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }
        
        .custom-dilution-input {
            padding: 0.5rem;
            border: 1px solid #444;
            border-radius: 4px;
            background: #333;
            color: #fff;
            width: 80px;
        }
        
        .scaled-ingredients {
            background: #333;
            padding: 1.2rem;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .scaled-ingredient {
            display: flex;
            justify-content: space-between;
            padding: 0.4rem 0;
            border-bottom: 1px solid #444;
            font-size: 0.9rem;
        }
        
        .ingredient-change {
            color: #888;
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }
        
        /* UPDATED: Final volume and servings info - MOVED TO BOTTOM */
        .scale-summary {
            background: #333;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            text-align: center;
        }
        
        .scale-summary-item {
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }
        
        .scale-summary-value {
            color: #FFB366;
            font-weight: 600;
        }
        
        /* UPDATED: Settings Styles with inline add fields */
        .settings-section {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .settings-title {
            color: #FFB366;
            margin-bottom: 1rem;
        }
        
        .add-item-form {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            align-items: center;
        }
        
        .add-item-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #444;
            border-radius: 8px;
            background: #333;
            color: #fff;
            font-size: 0.9rem;
        }
        
        .add-item-btn {
            background: #4CAF50;
            color: #fff;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            white-space: nowrap;
        }
        
        .add-item-btn:hover {
            background: #45a049;
        }
        
        .settings-list {
            list-style: none;
        }
        
        .settings-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: #333;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: background 0.2s;
        }
        
        .settings-item:hover {
            background: #3a3a3a;
        }
        
        .settings-item.dragging {
            background: #3a3a3a;
            border: 2px dashed #FFB366;
        }
        
        .drag-handle {
            cursor: grab;
            margin-right: 1rem;
            color: #888;
        }
        
        .settings-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .icon-button {
            background: none;
            border: none;
            color: #fff;
            cursor: pointer;
            padding: 0.25rem;
            font-size: 1.2rem;
        }
        
        .icon-button.delete {
            color: #f44336;
        }
        
        .buttons-row {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }
        
        /* Image Upload Styles */
        .image-upload {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .image-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
        }
        
        /* Drop Zone Styles */
        .drop-zone {
            border: 2px dashed #FFB366;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: background 0.2s;
            margin-bottom: 1rem;
        }
        
        .drop-zone:hover, .drop-zone.dragover {
            background: rgba(255, 179, 102, 0.1);
        }
        
        .drop-zone-text {
            color: #FFB366;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        
        .drop-zone-subtext {
            color: #888;
            font-size: 0.9rem;
        }
        
        /* Search and Filter Styles */
        .search-section {
            margin-bottom: 2rem;
        }
        
        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .filter-select {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #444;
            border-radius: 8px;
            background: #2a2a2a;
            color: #fff;
        }
        
        .sync-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #888;
            font-size: 0.9rem;
        }
        
        .sync-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .sync-indicator.synced {
            background: #4CAF50;
        }
        
        .sync-indicator.syncing {
            background: #FF9800;
            animation: pulse 1s infinite;
        }
        
        .sync-indicator.error {
            background: #f44336;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .sync-btn {
            background: #333;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .sync-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .sync-btn.syncing {
            animation: pulse 1s infinite;
        }
        
        /* UPDATED: Nav user with all buttons in single row */
        .nav-user {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: nowrap;
            margin-left: auto;
        }
        
        .nav-buttons {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: nowrap;
        }
        
        .add-recipe-btn {
            background: #4CAF50;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .add-recipe-btn:hover {
            background: #45a049;
        }
        
        .logout-btn {
            background: #333;
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .logout-btn:hover {
            background: #444;
        }
        
        /* UPDATED: Alphabet Navigation - RIGHT SIDE VERTICAL */
        .alphabet-nav {
            position: fixed;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 0.1rem;
            padding: 0.8rem 0.3rem;
            background: rgba(42, 42, 42, 0.95);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            z-index: 100;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 179, 102, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .alphabet-letter {
            color: #FFB366;
            text-decoration: none;
            font-weight: 600;
            padding: 0.3rem 0.5rem;
            min-width: 25px;
            text-align: center;
            border-radius: 4px;
            transition: all 0.2s;
            font-size: 0.8rem;
            cursor: pointer;
            line-height: 1.2;
        }
        
        .alphabet-letter:hover {
            background: rgba(255, 179, 102, 0.2);
            transform: scale(1.05);
        }
        
        .alphabet-section {
            margin-bottom: 2rem;
        }
        
        .letter-header {
            color: #FFB366;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #FFB366;
        }
        
        /* Main content with right-side alphabet */
        .main-content {
            display: flex;
            gap: 2rem;
            position: relative;
        }
        
        .recipes-container {
            flex: 1;
            margin-right: 50px; /* Space for alphabet nav */
        }
        
        /* Loading and Empty States */
        .loading {
            text-align: center;
            padding: 3rem;
            color: #888;
            font-style: italic;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem 1rem;
            color: #888;
            border-top: 1px solid #444;
            margin-top: 3rem;
        }
        
        .footer a {
            color: #FFB366;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .recipe-details-page {
                grid-template-columns: 1fr;
            }
            
            .scale-options {
                grid-template-columns: 1fr;
            }
            
            .scale-controls {
                grid-template-columns: 1fr;
            }
            
            .dilution-options {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .alphabet-nav {
                position: static;
                transform: none;
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                background: #2a2a2a;
                border-radius: 8px;
                padding: 0.8rem;
                margin-bottom: 1.5rem;
                max-height: none;
                width: 100%;
                box-shadow: none;
            }
            
            .recipes-container {
                margin-right: 0;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .nav-user {
                flex-direction: row;
                gap: 0.5rem;
            }
            
            .nav-buttons {
                gap: 0.5rem;
            }
            
            .add-item-form {
                flex-direction: column;
            }
            
            .recipe-header-container {
                flex-direction: row;
                align-items: center;
                gap: 0.75rem;
            }
            
            .recipe-title-header {
                font-size: 1.3rem;
            }
            
            /* UPDATED: Ensure square cards on mobile */
            .recipes-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.1cm;
            }
            
            .recipe-card {
                min-height: 140px;
                aspect-ratio: 3/4;
            }
            
            .recipe-image {
                height: 100px;
            }
            
            .recipe-name {
                font-size: 0.75rem;
            }
            
            .recipe-abv {
                font-size: 0.7rem;
            }
            
            .alphabet-letter {
                padding: 0.4rem 0.6rem;
                font-size: 0.85rem;
            }
        }
        
        /* Mobile-specific styles for 14" and 16" screens */
        @media (max-width: 1440px) and (min-width: 768px) {
            .container {
                max-width: 100%;
                padding: 0.75rem;
            }
            
            .recipes-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 0.1cm;
            }
            
            .recipe-card {
                min-height: 160px;
                aspect-ratio: 3/4;
            }
        }
        
        /* Small mobile devices */
        @media (max-width: 380px) {
            .recipes-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.1cm;
            }
            
            .recipe-card {
                min-height: 130px;
                aspect-ratio: 3/4;
            }
            
            .recipe-image {
                height: 90px;
                font-size: 1.5rem;
            }
            
            .recipe-name {
                font-size: 0.7rem;
            }
            
            .recipe-abv {
                font-size: 0.65rem;
            }
            
            .recipe-info {
                padding: 0.6rem;
            }
        }
        
        /* Responsive adjustments for header */
        @media (max-width: 768px) {
            .header {
                padding: 0.75rem;
            }
            
            .nav-user {
                gap: 0.5rem;
            }
            
            .nav-buttons {
                gap: 0.3rem;
            }
            
            .sync-status span {
                display: none; /* Hide sync text on small screens */
            }
            
            .add-recipe-btn, .logout-btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAjpIE5MO0hxtNPP6CgthUJTXCUdpBBOrU",
            authDomain: "cocktail-manual-app.firebaseapp.com",
            projectId: "cocktail-manual-app",
            storageBucket: "cocktail-manual-app.firebasestorage.app",
            messagingSenderId: "678623153357",
            appId: "1:678623153357:web:3596c04dc4e5374ea4ed84"
        };
        
        // Initialize Firebase
        let app;
        let db;
        let auth;
        
        try {
            if (typeof firebase === 'undefined') {
                throw new Error('Firebase SDK not loaded');
            }
            
            app = firebase.initializeApp(firebaseConfig);
            db = firebase.firestore(app);
            auth = firebase.auth(app);
            console.log('Firebase initialized successfully');
        } catch (error) {
            console.error('Firebase initialization error:', error);
            // Fallback: Create mock Firebase functions for offline use
            db = {
                collection: () => ({
                    doc: () => ({
                        set: () => Promise.resolve(),
                        get: () => Promise.resolve({ exists: false, data: () => null }),
                        onSnapshot: () => () => {}
                    })
                })
            };
            auth = {
                signInAnonymously: () => Promise.resolve(),
                signOut: () => Promise.resolve(),
                onAuthStateChanged: (callback) => {
                    callback({ uid: 'offline-user' });
                    return () => {};
                }
            };
        }
        
        // Authentication configuration
        const ADMIN_CREDENTIALS = {
            username: 'suraj',
            password: 'cocktail123'
        };
        
        // Load data from localStorage or use defaults
        const loadFromStorage = (key, defaultValue) => {
            try {
                const item = localStorage.getItem(key);
                return item ? JSON.parse(item) : defaultValue;
            } catch {
                return defaultValue;
            }
        };
        
        const saveToStorage = (key, value) => {
            try {
                localStorage.setItem(key, JSON.stringify(value));
                return true;
            } catch (error) {
                console.error('Error saving to localStorage:', error);
                return false;
            }
        };
        
        // Data management functions
        const getRecipes = () => {
            return loadFromStorage('cocktailRecipes', [
                {
                    id: '1',
                    name: 'Old Fashioned',
                    spirit_type: 'Whiskey',
                    venue: 'Main Bar',
                    glass_type: 'Old Fashioned',
                    abv: 35,
                    pour_cost: 4.50,
                    image_url: '',
                    ingredients: [
                        { name: 'Bourbon', amount: 60, unit: 'ml' },
                        { name: 'Sugar Cube', amount: 1, unit: 'piece' },
                        { name: 'Angostura Bitters', amount: 2, unit: 'dash' },
                        { name: 'Orange Peel', amount: 1, unit: 'piece' }
                    ],
                    instructions: 'Muddle sugar cube with bitters and a splash of water. Add bourbon and ice. Stir gently. Garnish with orange peel.',
                    notes: 'Use high-quality bourbon for best results.'
                },
                {
                    id: '2',
                    name: 'Margarita',
                    spirit_type: 'Tequila',
                    venue: 'Pool Bar',
                    glass_type: 'Margarita',
                    abv: 25,
                    pour_cost: 3.75,
                    image_url: '',
                    ingredients: [
                        { name: 'Tequila', amount: 50, unit: 'ml' },
                        { name: 'Lime Juice', amount: 25, unit: 'ml' },
                        { name: 'Triple Sec', amount: 20, unit: 'ml' },
                        { name: 'Agave Syrup', amount: 10, unit: 'ml' }
                    ],
                    instructions: 'Shake all ingredients with ice. Strain into salt-rimmed glass. Garnish with lime wheel.',
                    notes: 'Use fresh lime juice for optimal flavor.'
                },
                {
                    id: '3',
                    name: 'Negroni',
                    spirit_type: 'Gin',
                    venue: 'Main Bar',
                    glass_type: 'Old Fashioned',
                    abv: 28,
                    pour_cost: 5.25,
                    image_url: '',
                    ingredients: [
                        { name: 'Gin', amount: 30, unit: 'ml' },
                        { name: 'Campari', amount: 30, unit: 'ml' },
                        { name: 'Sweet Vermouth', amount: 30, unit: 'ml' },
                        { name: 'Orange Peel', amount: 1, unit: 'piece' }
                    ],
                    instructions: 'Stir all ingredients with ice. Strain into glass. Garnish with orange peel.',
                    notes: 'Equal parts make this cocktail perfectly balanced.'
                },
                {
                    id: '4',
                    name: 'Mojito',
                    spirit_type: 'Rum',
                    venue: 'Pool Bar',
                    glass_type: 'Highball',
                    abv: 15,
                    pour_cost: 3.25,
                    image_url: '',
                    ingredients: [
                        { name: 'White Rum', amount: 50, unit: 'ml' },
                        { name: 'Lime Juice', amount: 25, unit: 'ml' },
                        { name: 'Mint Leaves', amount: 10, unit: 'leaves' },
                        { name: 'Sugar', amount: 2, unit: 'tsp' },
                        { name: 'Soda Water', amount: 100, unit: 'ml' }
                    ],
                    instructions: 'Muddle mint leaves with sugar and lime juice. Add rum and ice. Top with soda water. Garnish with mint sprig.',
                    notes: 'Use fresh mint for best aroma.'
                },
                {
                    id: '5',
                    name: 'Martini',
                    spirit_type: 'Gin',
                    venue: 'Main Bar',
                    glass_type: 'Martini',
                    abv: 30,
                    pour_cost: 4.75,
                    image_url: '',
                    ingredients: [
                        { name: 'Gin', amount: 60, unit: 'ml' },
                        { name: 'Dry Vermouth', amount: 10, unit: 'ml' },
                        { name: 'Olive', amount: 1, unit: 'piece' }
                    ],
                    instructions: 'Stir gin and vermouth with ice. Strain into chilled martini glass. Garnish with olive.',
                    notes: 'Shake for a colder, more diluted drink.'
                },
                {
                    id: '6',
                    name: 'Daiquiri',
                    spirit_type: 'Rum',
                    venue: 'Pool Bar',
                    glass_type: 'Coupe',
                    abv: 20,
                    pour_cost: 3.50,
                    image_url: '',
                    ingredients: [
                        { name: 'White Rum', amount: 50, unit: 'ml' },
                        { name: 'Lime Juice', amount: 25, unit: 'ml' },
                        { name: 'Simple Syrup', amount: 20, unit: 'ml' }
                    ],
                    instructions: 'Shake all ingredients with ice. Strain into chilled coupe glass.',
                    notes: 'Use fresh lime juice for best results.'
                },
                {
                    id: '7',
                    name: 'Whiskey Sour',
                    spirit_type: 'Whiskey',
                    venue: 'Main Bar',
                    glass_type: 'Old Fashioned',
                    abv: 22,
                    pour_cost: 4.25,
                    image_url: '',
                    ingredients: [
                        { name: 'Bourbon', amount: 60, unit: 'ml' },
                        { name: 'Lemon Juice', amount: 25, unit: 'ml' },
                        { name: 'Simple Syrup', amount: 20, unit: 'ml' },
                        { name: 'Egg White', amount: 1, unit: 'piece' }
                    ],
                    instructions: 'Dry shake all ingredients without ice. Add ice and shake again. Strain into glass.',
                    notes: 'Dry shaking creates better foam from the egg white.'
                },
                {
                    id: '8',
                    name: 'Manhattan',
                    spirit_type: 'Whiskey',
                    venue: 'Main Bar',
                    glass_type: 'Coupe',
                    abv: 32,
                    pour_cost: 5.50,
                    image_url: '',
                    ingredients: [
                        { name: 'Rye Whiskey', amount: 60, unit: 'ml' },
                        { name: 'Sweet Vermouth', amount: 30, unit: 'ml' },
                        { name: 'Angostura Bitters', amount: 2, unit: 'dash' },
                        { name: 'Cherry', amount: 1, unit: 'piece' }
                    ],
                    instructions: 'Stir all ingredients with ice. Strain into chilled coupe glass. Garnish with cherry.',
                    notes: 'Rye whiskey provides a spicier flavor profile.'
                }
            ]);
        };
        
        const saveRecipes = (recipes) => {
            return saveToStorage('cocktailRecipes', recipes);
        };
        
        const getSyrups = () => {
            return loadFromStorage('cocktailSyrups', [
                {
                    id: '1',
                    name: 'Simple Syrup',
                    type: 'Syrup',
                    ingredients: [
                        { name: 'Sugar', amount: 1, unit: 'cup' },
                        { name: 'Water', amount: 1, unit: 'cup' }
                    ],
                    instructions: 'Heat water and sugar in saucepan until sugar dissolves completely. Cool before use.',
                    shelf_life: '1 month refrigerated',
                    storage: 'Airtight container in refrigerator',
                    cost: 0.50,
                    image_url: ''
                },
                {
                    id: '2',
                    name: 'Ginger Syrup',
                    type: 'Syrup',
                    ingredients: [
                        { name: 'Fresh Ginger', amount: 100, unit: 'gram' },
                        { name: 'Sugar', amount: 1, unit: 'cup' },
                        { name: 'Water', amount: 1, unit: 'cup' }
                    ],
                    instructions: 'Peel and slice ginger. Simmer with water and sugar for 15 minutes. Strain and cool.',
                    shelf_life: '2 weeks refrigerated',
                    storage: 'Airtight container in refrigerator',
                    cost: 1.25,
                    image_url: ''
                }
            ]);
        };
        
        const saveSyrups = (syrups) => {
            return saveToStorage('cocktailSyrups', syrups);
        };
        
        const getSettings = () => {
            return loadFromStorage('cocktailSettings', {
                spirit_types: ['Gin', 'Vodka', 'Rum', 'Tequila', 'Whiskey', 'Brandy'],
                glass_types: ['Coupe', 'Martini', 'Highball', 'Old Fashioned', 'Collins', 'Margarita'],
                venues: ['Main Bar', 'Pool Bar', 'Restaurant', 'Private Event']
            });
        };
        
        const saveSettings = (settings) => {
            return saveToStorage('cocktailSettings', settings);
        };

        // Utility function to convert image to base64
        const convertImageToBase64 = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        };

        // Enhanced Firebase Data Management for Auto Sync
        const syncRecipesWithFirebase = async (recipes) => {
            try {
                console.log('Syncing recipes to Firebase:', recipes.length, 'recipes');
                await db.collection('sharedData').doc('recipes').set({
                    data: recipes,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedBy: auth.currentUser ? auth.currentUser.uid : 'anonymous',
                    version: Date.now()
                });
                console.log('Recipes synced successfully');
                return true;
            } catch (error) {
                console.error('Error syncing recipes with Firebase:', error);
                return false;
            }
        };

        const syncSyrupsWithFirebase = async (syrups) => {
            try {
                console.log('Syncing syrups to Firebase:', syrups.length, 'syrups');
                await db.collection('sharedData').doc('syrups').set({
                    data: syrups,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedBy: auth.currentUser ? auth.currentUser.uid : 'anonymous',
                    version: Date.now()
                });
                console.log('Syrups synced successfully');
                return true;
            } catch (error) {
                console.error('Error syncing syrups with Firebase:', error);
                return false;
            }
        };

        const syncSettingsWithFirebase = async (settings) => {
            try {
                console.log('Syncing settings to Firebase');
                await db.collection('sharedData').doc('settings').set({
                    data: settings,
                    lastUpdated: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedBy: auth.currentUser ? auth.currentUser.uid : 'anonymous',
                    version: Date.now()
                });
                console.log('Settings synced successfully');
                return true;
            } catch (error) {
                console.error('Error syncing settings with Firebase:', error);
                return false;
            }
        };

        const loadRecipesFromFirebase = async () => {
            try {
                console.log('Loading recipes from Firebase...');
                const doc = await db.collection('sharedData').doc('recipes').get();
                if (doc.exists) {
                    const data = doc.data();
                    console.log('Recipes loaded from Firebase:', data.data.length, 'recipes');
                    return data.data || [];
                }
                console.log('No recipes found in Firebase');
                return [];
            } catch (error) {
                console.error('Error loading recipes from Firebase:', error);
                return null;
            }
        };

        const loadSyrupsFromFirebase = async () => {
            try {
                console.log('Loading syrups from Firebase...');
                const doc = await db.collection('sharedData').doc('syrups').get();
                if (doc.exists) {
                    const data = doc.data();
                    console.log('Syrups loaded from Firebase:', data.data.length, 'syrups');
                    return data.data || [];
                }
                console.log('No syrups found in Firebase');
                return [];
            } catch (error) {
                console.error('Error loading syrups from Firebase:', error);
                return null;
            }
        };

        const loadSettingsFromFirebase = async () => {
            try {
                console.log('Loading settings from Firebase...');
                const doc = await db.collection('sharedData').doc('settings').get();
                if (doc.exists) {
                    const data = doc.data();
                    console.log('Settings loaded from Firebase');
                    return data.data || getSettings();
                }
                console.log('No settings found in Firebase');
                return getSettings();
            } catch (error) {
                console.error('Error loading settings from Firebase:', error);
                return null;
            }
        };

        // Set up real-time listeners for data changes
        const setupFirebaseListeners = (onRecipesUpdate, onSyrupsUpdate, onSettingsUpdate) => {
            console.log('Setting up Firebase real-time listeners...');
            
            try {
                const recipesUnsubscribe = db.collection('sharedData').doc('recipes')
                    .onSnapshot((doc) => {
                        if (doc.exists) {
                            const data = doc.data();
                            console.log('Real-time update: Recipes updated from cloud', data.data.length, 'recipes');
                            onRecipesUpdate(data.data || []);
                        }
                    }, (error) => {
                        console.error('Error listening to recipes:', error);
                    });
                
                const syrupsUnsubscribe = db.collection('sharedData').doc('syrups')
                    .onSnapshot((doc) => {
                        if (doc.exists) {
                            const data = doc.data();
                            console.log('Real-time update: Syrups updated from cloud', data.data.length, 'syrups');
                            onSyrupsUpdate(data.data || []);
                        }
                    }, (error) => {
                        console.error('Error listening to syrups:', error);
                    });
                
                const settingsUnsubscribe = db.collection('sharedData').doc('settings')
                    .onSnapshot((doc) => {
                        if (doc.exists) {
                            const data = doc.data();
                            console.log('Real-time update: Settings updated from cloud');
                            onSettingsUpdate(data.data || getSettings());
                        }
                    }, (error) => {
                        console.error('Error listening to settings:', error);
                    });
                
                console.log('Firebase listeners setup complete');
                
                return () => {
                    recipesUnsubscribe();
                    syrupsUnsubscribe();
                    settingsUnsubscribe();
                    console.log('Firebase listeners cleaned up');
                };
            } catch (error) {
                console.error('Error setting up Firebase listeners:', error);
                return () => {}; // Return empty cleanup function
            }
        };

        // Drag and Drop functionality
        const reorder = (list, startIndex, endIndex) => {
            const result = Array.from(list);
            const [removed] = result.splice(startIndex, 1);
            result.splice(endIndex, 0, removed);
            return result;
        };

        // Share functionality
        const shareContent = async (content, title = 'Cocktail Codex') => {
            const text = `${title}\n\n${content}`;
            
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: title,
                        text: text
                    });
                } catch (error) {
                    if (error.name !== 'AbortError') {
                        fallbackShare(text, title);
                    }
                }
            } else {
                fallbackShare(text, title);
            }
        };

        const fallbackShare = (text, title) => {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('Copied to clipboard!');
                }).catch(() => {
                    prompt('Copy this text:', text);
                });
            } else {
                prompt('Copy this text:', text);
            }
        };

        const generateRecipeShareText = (recipe) => {
            let text = `üêë ${recipe.name}\n`;
            text += `Spirit: ${recipe.spirit_type}\n`;
            text += `Glass: ${recipe.glass_type}\n`;
            text += `ABV: ${recipe.abv}% | Cost: $${recipe.pour_cost}\n\n`;
            
            text += `INGREDIENTS:\n`;
            recipe.ingredients.forEach(ingredient => {
                text += `‚Ä¢ ${ingredient.name}: ${ingredient.amount} ${ingredient.unit}\n`;
            });
            
            text += `\nINSTRUCTIONS:\n${recipe.instructions}\n`;
            
            if (recipe.notes) {
                text += `\nNOTES:\n${recipe.notes}\n`;
            }
            
            text += `\n---\nShared from Cocktail Codex`;
            return text;
        };

        const generateSyrupShareText = (syrup) => {
            let text = `üß™ ${syrup.name} (${syrup.type})\n\n`;
            
            if (syrup.ingredients && syrup.ingredients.length > 0) {
                text += `INGREDIENTS:\n`;
                syrup.ingredients.forEach(ingredient => {
                    text += `‚Ä¢ ${ingredient.name}: ${ingredient.amount} ${ingredient.unit}\n`;
                });
                text += `\n`;
            }
            
            if (syrup.instructions) {
                text += `INSTRUCTIONS:\n${syrup.instructions}\n\n`;
            }
            
            if (syrup.shelf_life) {
                text += `Shelf Life: ${syrup.shelf_life}\n`;
            }
            
            if (syrup.storage) {
                text += `Storage: ${syrup.storage}\n`;
            }
            
            // ADDED: Include cost if available
            if (syrup.cost) {
                text += `Cost: $${syrup.cost}\n`;
            }
            
            text += `\n---\nShared from Cocktail Codex`;
            return text;
        };

        // Scale functionality
        const calculateTotalVolume = (ingredients) => {
            return ingredients.reduce((total, ingredient) => {
                if (['ml', 'oz'].includes(ingredient.unit)) {
                    return total + parseFloat(ingredient.amount);
                }
                return total;
            }, 0);
        };

        // FIXED: Correct dilution formula - water dilution should be divided by total volume
        const scaleIngredients = (ingredients, scaleFactor, dilutionPercentage = 0) => {
            const scaledIngredients = ingredients.map(ingredient => ({
                ...ingredient,
                scaledAmount: Math.round(ingredient.amount * scaleFactor * 10) / 10
            }));

            // Add dilution if specified - FIXED FORMULA
            if (dilutionPercentage > 0) {
                const totalVolume = calculateTotalVolume(scaledIngredients);
                // Correct formula: dilutionAmount = (totalVolume * dilutionPercentage) / 100
                const dilutionAmount = (totalVolume * dilutionPercentage) / 100;
                
                if (dilutionAmount > 0) {
                    scaledIngredients.push({
                        name: 'Water (dilution)',
                        amount: Math.round(dilutionAmount * 10) / 10,
                        unit: 'ml',
                        scaledAmount: Math.round(dilutionAmount * 10) / 10,
                        isDilution: true
                    });
                }
            }

            return scaledIngredients;
        };

        // UPDATED: Scale Recipe Modal Component with final volume and exact servings at bottom
        function ScaleRecipeModal({ recipe, onClose }) {
            const [scaleType, setScaleType] = useState('servings'); // 'servings' or 'volume'
            const [servings, setServings] = useState(1);
            const [totalVolume, setTotalVolume] = useState('');
            const [volumeUnit, setVolumeUnit] = useState('ml');
            const [dilutionPercentage, setDilutionPercentage] = useState(0);
            const [customDilution, setCustomDilution] = useState('');
            const [scaledIngredients, setScaledIngredients] = useState([]);
            
            // Calculate scale factor based on current settings
            const calculateScaleFactor = () => {
                if (scaleType === 'servings') {
                    return servings;
                } else {
                    // Calculate based on total volume
                    const originalVolume = calculateTotalVolume(recipe.ingredients);
                    if (originalVolume === 0) return 1;
                    
                    let targetVolume = parseFloat(totalVolume);
                    if (volumeUnit === 'oz') {
                        targetVolume = targetVolume * 29.5735; // Convert oz to ml
                    }
                    
                    return targetVolume / originalVolume;
                }
            };

            // Calculate final volume and servings
            const calculateFinalVolume = () => {
                const scaleFactor = calculateScaleFactor();
                const dilution = customDilution ? parseFloat(customDilution) : dilutionPercentage;
                
                const baseVolume = calculateTotalVolume(recipe.ingredients) * scaleFactor;
                const dilutionVolume = dilution > 0 ? (baseVolume * dilution) / 100 : 0;
                
                return baseVolume + dilutionVolume;
            };

            const calculateFinalServings = () => {
                const originalVolume = calculateTotalVolume(recipe.ingredients);
                const finalVolume = calculateFinalVolume();
                
                if (originalVolume === 0) return 1;
                return finalVolume / originalVolume;
            };

            // Update scaled ingredients when settings change
            useEffect(() => {
                const scaleFactor = calculateScaleFactor();
                const dilution = customDilution ? parseFloat(customDilution) : dilutionPercentage;
                setScaledIngredients(scaleIngredients(recipe.ingredients, scaleFactor, dilution));
            }, [scaleType, servings, totalVolume, volumeUnit, dilutionPercentage, customDilution, recipe.ingredients]);

            const handleServingsChange = (e) => {
                const value = parseFloat(e.target.value) || 1;
                setServings(Math.max(0.1, value));
            };

            const handleTotalVolumeChange = (e) => {
                setTotalVolume(e.target.value);
            };

            const handleDilutionSelect = (percentage) => {
                setDilutionPercentage(percentage);
                setCustomDilution('');
            };

            const handleCustomDilutionChange = (e) => {
                const value = e.target.value;
                setCustomDilution(value);
                if (value) {
                    setDilutionPercentage(0);
                }
            };

            // UPDATED: Close modal when clicking outside
            const handleOverlayClick = (e) => {
                if (e.target === e.currentTarget) {
                    onClose();
                }
            };

            const shareScaledRecipe = () => {
                const scaleFactor = calculateScaleFactor();
                const dilution = customDilution ? parseFloat(customDilution) : dilutionPercentage;
                
                const scaledRecipe = {
                    ...recipe,
                    ingredients: scaledIngredients
                };
                
                let shareText = generateRecipeShareText(scaledRecipe);
                
                // Add scaling information
                let scalingInfo = '';
                if (scaleType === 'servings') {
                    scalingInfo = `Scaled to ${servings} serving${servings !== 1 ? 's' : ''}`;
                } else {
                    scalingInfo = `Scaled to ${totalVolume} ${volumeUnit} total volume`;
                }
                
                if (dilution > 0) {
                    scalingInfo += ` with ${dilution}% dilution`;
                }
                
                shareText = shareText.replace('Shared from Cocktail Codex', `${scalingInfo} | Shared from Cocktail Codex`);
                
                shareContent(shareText, `Scaled ${recipe.name} Recipe`);
            };

            const scaleFactor = calculateScaleFactor();
            const currentDilution = customDilution ? parseFloat(customDilution) : dilutionPercentage;
            const finalVolume = calculateFinalVolume();
            const finalServings = calculateFinalServings();

            return (
                <div className="modal-overlay" onClick={handleOverlayClick}>
                    <div className="modal">
                        <h2 className="modal-title">Scale: {recipe.name}</h2>

                        {/* Step 1: Scale Type Selection */}
                        <div className="scale-step">
                            <h3 className="step-title">Scaling Method</h3>
                            <div className="scale-options">
                                <div className="scale-option">
                                    <div 
                                        className={`option-card ${scaleType === 'servings' ? 'selected' : ''}`}
                                        onClick={() => setScaleType('servings')}
                                    >
                                        <div className="option-title">By Servings</div>
                                        <div className="option-description">
                                            Choose number of servings needed.
                                        </div>
                                    </div>
                                </div>
                                <div className="scale-option">
                                    <div 
                                        className={`option-card ${scaleType === 'volume' ? 'selected' : ''}`}
                                        onClick={() => setScaleType('volume')}
                                    >
                                        <div className="option-title">By Volume</div>
                                        <div className="option-description">
                                            For specific container or batch size.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Step 2: Quantity Input */}
                        <div className="scale-step">
                            <h3 className="step-title">Quantity</h3>
                            {scaleType === 'servings' ? (
                                <div className="scale-controls">
                                    <div className="scale-input-group">
                                        <label className="form-label">Servings</label>
                                        <input
                                            type="number"
                                            className="scale-input"
                                            value={servings}
                                            onChange={handleServingsChange}
                                            min="0.1"
                                            max="100"
                                            step="0.1"
                                        />
                                    </div>
                                </div>
                            ) : (
                                <div className="scale-controls">
                                    <div className="scale-input-group">
                                        <label className="form-label">Total Volume</label>
                                        <input
                                            type="number"
                                            className="scale-input"
                                            value={totalVolume}
                                            onChange={handleTotalVolumeChange}
                                            min="1"
                                            step="1"
                                            placeholder="Enter volume"
                                        />
                                    </div>
                                    <div className="scale-input-group">
                                        <label className="form-label">Unit</label>
                                        <select
                                            className="scale-input"
                                            value={volumeUnit}
                                            onChange={(e) => setVolumeUnit(e.target.value)}
                                        >
                                            <option value="ml">ml</option>
                                            <option value="oz">oz</option>
                                        </select>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Step 3: Dilution Options */}
                        <div className="scale-step">
                            <h3 className="step-title">Dilution (Optional)</h3>
                            
                            <div className="dilution-options">
                                <div 
                                    className={`dilution-option ${dilutionPercentage === 0 && !customDilution ? 'selected' : ''}`}
                                    onClick={() => handleDilutionSelect(0)}
                                >
                                    <div className="dilution-percentage">0%</div>
                                    <div className="dilution-description">No Dilution</div>
                                </div>
                                <div 
                                    className={`dilution-option ${dilutionPercentage === 18 ? 'selected' : ''}`}
                                    onClick={() => handleDilutionSelect(18)}
                                >
                                    <div className="dilution-percentage">18%</div>
                                    <div className="dilution-description">Spirit-Driven</div>
                                </div>
                                <div 
                                    className={`dilution-option ${dilutionPercentage === 25 ? 'selected' : ''}`}
                                    onClick={() => handleDilutionSelect(25)}
                                >
                                    <div className="dilution-percentage">25%</div>
                                    <div className="dilution-description">Shaken</div>
                                </div>
                            </div>
                            
                            <div className="custom-dilution">
                                <span style={{color: '#FFB366'}}>Custom:</span>
                                <input
                                    type="number"
                                    className="custom-dilution-input"
                                    value={customDilution}
                                    onChange={handleCustomDilutionChange}
                                    placeholder="Enter %"
                                    min="0"
                                    max="50"
                                />
                                <span>%</span>
                            </div>
                        </div>

                        {/* Scaled Ingredients Preview */}
                        <div className="scaled-ingredients">
                            <h3 style={{color: '#FFB366', marginBottom: '1rem'}}>
                                Scaled Ingredients {scaleFactor !== 1 && `(${scaleFactor.toFixed(2)}x)`}
                            </h3>
                            {scaledIngredients.map((ingredient, index) => (
                                <div key={index} className="scaled-ingredient">
                                    <span>
                                        {ingredient.name}
                                        {ingredient.isDilution && <span style={{color: '#888', fontSize: '0.8rem'}}> (dilution)</span>}
                                    </span>
                                    <span>
                                        <strong>{ingredient.scaledAmount}</strong> {ingredient.unit}
                                        {scaleFactor !== 1 && !ingredient.isDilution && (
                                            <span className="ingredient-change">
                                                (was {ingredient.amount})
                                            </span>
                                        )}
                                    </span>
                                </div>
                            ))}
                        </div>
                        
                        {/* UPDATED: Final volume and servings summary - MOVED TO BOTTOM */}
                        <div className="scale-summary">
                            <div className="scale-summary-item">
                                Final Volume: <span className="scale-summary-value">{finalVolume.toFixed(1)} ml</span>
                            </div>
                            <div className="scale-summary-item">
                                Servings: <span className="scale-summary-value">{finalServings.toFixed(2)}</span>
                            </div>
                        </div>
                        
                        <div className="action-buttons" style={{marginTop: '1.5rem'}}>
                            <button className="action-button share" onClick={shareScaledRecipe}>
                                üì§ Share Scaled
                            </button>
                            <button className="action-button" onClick={onClose}>
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Authentication Hook
        function useAuth() {
            const [user, setUser] = useState(null);
            const [firebaseUser, setFirebaseUser] = useState(null);
            
            useEffect(() => {
                const savedUser = localStorage.getItem('cocktailAppUser');
                if (savedUser) {
                    setUser(JSON.parse(savedUser));
                }
                
                const unsubscribe = auth.onAuthStateChanged((firebaseUser) => {
                    setFirebaseUser(firebaseUser);
                    console.log('Firebase auth state changed:', firebaseUser ? 'Logged in' : 'Logged out');
                });
                
                return () => unsubscribe();
            }, []);
            
            const login = async (username, password) => {
                if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                    const userData = { username, isAdmin: true };
                    setUser(userData);
                    localStorage.setItem('cocktailAppUser', JSON.stringify(userData));
                    
                    try {
                        await auth.signInAnonymously();
                        console.log('Admin logged in and authenticated with Firebase');
                    } catch (error) {
                        console.error('Firebase auth error:', error);
                    }
                    
                    return true;
                }
                return false;
            };
            
            const loginAsGuest = async () => {
                const guestUser = { username: 'Guest', isAdmin: false };
                setUser(guestUser);
                localStorage.setItem('cocktailAppUser', JSON.stringify(guestUser));
                
                try {
                    await auth.signInAnonymously();
                    console.log('Guest logged in and authenticated with Firebase');
                } catch (error) {
                    console.error('Firebase auth error:', error);
                }
                
                return true;
            };
            
            const logout = () => {
                setUser(null);
                localStorage.removeItem('cocktailAppUser');
                auth.signOut();
                console.log('User logged out');
            };
            
            return { user, firebaseUser, login, loginAsGuest, logout };
        }

        // Hamburger Menu Component
        function HamburgerMenu({ isOpen, onToggle, currentPage, onNavigate, isAdmin }) {
            const menuRef = useRef(null);
            
            useEffect(() => {
                const handleClickOutside = (event) => {
                    if (menuRef.current && !menuRef.current.contains(event.target) && 
                        !event.target.closest('.menu-button')) {
                        onToggle(false);
                    }
                };
                
                if (isOpen) {
                    document.addEventListener('mousedown', handleClickOutside);
                    document.addEventListener('touchstart', handleClickOutside);
                }
                
                return () => {
                    document.removeEventListener('mousedown', handleClickOutside);
                    document.removeEventListener('touchstart', handleClickOutside);
                };
            }, [isOpen, onToggle]);
            
            const handleNavigation = (page) => {
                onNavigate(page);
                onToggle(false);
            };
            
            return (
                <>
                    <div className={`side-menu-overlay ${isOpen ? 'active' : ''}`} />
                    <div ref={menuRef} className={`side-menu ${isOpen ? 'active' : ''}`}>
                        <div className="side-menu-header">
                            <div className="side-menu-logo">üêë</div>
                            <div className="side-menu-title">Cocktail Codex</div>
                        </div>
                        
                        <nav className="side-menu-nav">
                            <button 
                                className={`side-menu-button ${currentPage === 'home' ? 'active' : ''}`}
                                onClick={() => handleNavigation('home')}
                            >
                                üìñ Cocktail Codex
                            </button>
                            
                            <button 
                                className={`side-menu-button ${currentPage === 'syrups' ? 'active' : ''}`}
                                onClick={() => handleNavigation('syrups')}
                            >
                                üß™ Syrups & Infusions
                            </button>
                            
                            <button 
                                className={`side-menu-button ${currentPage === 'settings' ? 'active' : ''} ${
                                    !isAdmin ? 'disabled' : ''
                                }`}
                                onClick={() => isAdmin && handleNavigation('settings')}
                                title={!isAdmin ? 'Admin access required' : ''}
                            >
                                ‚öôÔ∏è Settings
                            </button>
                        </nav>
                    </div>
                </>
            );
        }

        // UPDATED: Recipe Card Component with image filling the entire card and name/ABV on same line
        function RecipeCard({ recipe, onClick, isAdmin }) {
            const imageStyle = {
                backgroundImage: recipe.image_url ? `url(${recipe.image_url})` : 'none',
                backgroundSize: 'cover',
                backgroundPosition: 'center'
            };
            
            return (
                <div className="recipe-card" onClick={() => onClick(recipe)}>
                    <div className={`recipe-image ${recipe.image_url ? 'normal' : ''}`} style={imageStyle}>
                        {!recipe.image_url && 'üêë'}
                    </div>
                    {/* UPDATED: Name and ABV positioned at bottom with gradient overlay - SAME LINE */}
                    <div className="recipe-info">
                        <div className="recipe-name-abv-container">
                            <span className="recipe-name">{recipe.name}</span>
                            <span className="recipe-abv">{recipe.abv}%</span>
                        </div>
                    </div>
                </div>
            );
        }

        // UPDATED: Syrup Card Component with same layout pattern
        function SyrupCard({ syrup, onClick, isAdmin }) {
            const imageStyle = {
                backgroundImage: syrup.image_url ? `url(${syrup.image_url})` : 'none',
                backgroundSize: 'cover',
                backgroundPosition: 'center'
            };
            
            return (
                <div className="recipe-card" onClick={() => onClick(syrup)}>
                    <div className={`recipe-image ${syrup.image_url ? 'normal' : ''}`} style={imageStyle}>
                        {!syrup.image_url && 'üß™'}
                    </div>
                    <div className="recipe-info">
                        <div className="recipe-name-abv-container">
                            <span className="recipe-name">{syrup.name}</span>
                            {syrup.shelf_life && (
                                <span className="recipe-abv">{syrup.shelf_life}</span>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // FIXED: Alphabet Navigation Component - RIGHT SIDE VERTICAL
        function AlphabetNav({ letters, onLetterClick }) {
            return (
                <div className="alphabet-nav">
                    {letters.map(letter => (
                        <div
                            key={letter}
                            className="alphabet-letter"
                            onClick={() => onLetterClick(letter)}
                        >
                            {letter}
                        </div>
                    ))}
                </div>
            );
        }

        // FIXED: Home Page Component with Right-Side Alphabet Navigation
        function HomePage({ onRecipeClick, onDeleteRecipe, isAdmin, onCreateRecipe, recipes, syncStatus, onManualSync }) {
            const [searchTerm, setSearchTerm] = useState('');
            const [filterSpirit, setFilterSpirit] = useState('All');
            const [filterVenue, setFilterVenue] = useState('All');
            const settings = getSettings();
            
            // Filter recipes based on search and filters
            const filteredRecipes = recipes.filter(recipe => {
                const matchesSearch = recipe.name.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesSpirit = filterSpirit === 'All' || recipe.spirit_type === filterSpirit;
                const matchesVenue = filterVenue === 'All' || recipe.venue === filterVenue;
                
                return matchesSearch && matchesSpirit && matchesVenue;
            });
            
            // Group recipes by first letter
            const groupedRecipes = filteredRecipes.reduce((groups, recipe) => {
                const firstLetter = recipe.name.charAt(0).toUpperCase();
                if (!groups[firstLetter]) {
                    groups[firstLetter] = [];
                }
                groups[firstLetter].push(recipe);
                return groups;
            }, {});
            
            // Sort the groups alphabetically
            const sortedLetters = Object.keys(groupedRecipes).sort();
            
            // Scroll to letter function
            const scrollToLetter = (letter) => {
                const element = document.getElementById(`letter-${letter}`);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            };
            
            return (
                <div className="container">
                    <div className="search-section">
                        <input 
                            type="text"
                            className="search-box"
                            placeholder="Search cocktails..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                        />
                        
                        <div className="filters">
                            <select 
                                className="filter-select"
                                value={filterSpirit}
                                onChange={(e) => setFilterSpirit(e.target.value)}
                            >
                                <option value="All">All Spirits</option>
                                {settings.spirit_types.map(spirit => (
                                    <option key={spirit} value={spirit}>{spirit}</option>
                                ))}
                            </select>
                            
                            <select 
                                className="filter-select"
                                value={filterVenue}
                                onChange={(e) => setFilterVenue(e.target.value)}
                            >
                                <option value="All">All Venues</option>
                                {settings.venues.map(venue => (
                                    <option key={venue} value={venue}>{venue}</option>
                                ))}
                            </select>
                        </div>
                    </div>
                    
                    <div className="main-content">
                        <div className="recipes-container">
                            {filteredRecipes.length === 0 ? (
                                <div className="loading">
                                    {recipes.length === 0 ? (
                                        'No cocktails available. Login as admin to add recipes.'
                                    ) : (
                                        'No cocktails found matching your criteria.'
                                    )}
                                </div>
                            ) : (
                                <>
                                    {sortedLetters.map(letter => (
                                        <div key={letter} id={`letter-${letter}`} className="alphabet-section">
                                            <h2 className="letter-header">{letter}</h2>
                                            <div className="recipes-grid">
                                                {groupedRecipes[letter].map(recipe => (
                                                    <RecipeCard 
                                                        key={recipe.id}
                                                        recipe={recipe}
                                                        onClick={onRecipeClick}
                                                        isAdmin={isAdmin}
                                                    />
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </>
                            )}
                        </div>
                        
                        {/* FIXED: Right-side Alphabet Navigation - Always visible when there are letters */}
                        {sortedLetters.length > 0 && (
                            <AlphabetNav letters={sortedLetters} onLetterClick={scrollToLetter} />
                        )}
                    </div>
                </div>
            );
        }

        // UPDATED: View Recipe Component with back arrow and name side by side - no table layout
        function ViewRecipePage({ recipe, onBack, isAdmin, onDeleteRecipe, onEditRecipe }) {
            const [showScaleModal, setShowScaleModal] = useState(false);
            const backgroundStyle = {
                backgroundImage: recipe.image_url ? `url(${recipe.image_url})` : 'none'
            };
            
            const handleShareRecipe = () => {
                const shareText = generateRecipeShareText(recipe);
                shareContent(shareText, `${recipe.name} Recipe`);
            };
            
            return (
                <div className="container">
                    {/* UPDATED: Back arrow and name side by side - smaller */}
                    <div className="recipe-header-container">
                        <button className="back-arrow" onClick={onBack}>
                            ‚Üê
                        </button>
                        <h1 className="recipe-title-header">{recipe.name}</h1>
                    </div>
                    
                    <div className="recipe-view">
                        {/* UPDATED: Background picture with reduced blur to be more visible */}
                        {recipe.image_url && (
                            <div className="recipe-background" style={backgroundStyle}></div>
                        )}
                        
                        <div className="recipe-content">
                            <div className="recipe-header">
                                <div className="recipe-meta">
                                    <div className="meta-item">{recipe.spirit_type}</div>
                                    <div className="meta-item">{recipe.glass_type} Glass</div>
                                    <div className="meta-item">{recipe.abv}% ABV</div>
                                    <div className="meta-item">${recipe.pour_cost} Cost</div>
                                    <div className="meta-item">{recipe.venue}</div>
                                </div>
                            </div>
                            
                            {/* UPDATED: Remove table layout, use flex column */}
                            <div className="recipe-details-page">
                                <div>
                                    <h3 style={{color: '#FFB366', marginBottom: '1rem', fontSize: '1.1rem'}}>Ingredients</h3>
                                    <ul className="ingredients-list">
                                        {recipe.ingredients.map((ingredient, index) => (
                                            <li key={index} className="ingredient-item">
                                                <span>{ingredient.name}</span>
                                                <span>{ingredient.amount} {ingredient.unit}</span>
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                                
                                <div>
                                    <h3 style={{color: '#FFB366', marginBottom: '1rem', fontSize: '1.1rem'}}>Instructions</h3>
                                    <div className="instructions">{recipe.instructions}</div>
                                    
                                    {recipe.notes && (
                                        <>
                                            <h3 style={{color: '#FFB366', marginBottom: '1rem', marginTop: '1.5rem', fontSize: '1.1rem'}}>Notes</h3>
                                            <div className="instructions">{recipe.notes}</div>
                                        </>
                                    )}
                                    
                                    <div className="action-buttons">
                                        <button className="action-button scale" onClick={() => setShowScaleModal(true)}>
                                            ‚öñÔ∏è Scale
                                        </button>
                                        <button className="action-button share" onClick={handleShareRecipe}>
                                            üì§ Share
                                        </button>
                                        {isAdmin && (
                                            <>
                                                <button 
                                                    className="action-button edit"
                                                    onClick={() => {
                                                        if (onEditRecipe) {
                                                            onEditRecipe(recipe);
                                                        }
                                                    }}
                                                >
                                                    ‚úèÔ∏è Edit
                                                </button>
                                                <button 
                                                    className="action-button delete"
                                                    onClick={() => onDeleteRecipe(recipe.id)}
                                                >
                                                    üóëÔ∏è Delete
                                                </button>
                                            </>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {showScaleModal && (
                        <ScaleRecipeModal 
                            recipe={recipe} 
                            onClose={() => setShowScaleModal(false)} 
                        />
                    )}
                </div>
            );
        }

        // View Syrup Component with Scale and Share (with visible background)
        function ViewSyrupPage({ syrup, onBack, isAdmin, onDeleteSyrup, onEditSyrup }) {
            const [showScaleModal, setShowScaleModal] = useState(false);
            const backgroundStyle = {
                backgroundImage: syrup.image_url ? `url(${syrup.image_url})` : 'none'
            };
            
            const handleShareSyrup = () => {
                const shareText = generateSyrupShareText(syrup);
                shareContent(shareText, `${syrup.name} ${syrup.type}`);
            };
            
            return (
                <div className="container">
                    {/* UPDATED: Back arrow and name side by side */}
                    <div className="recipe-header-container">
                        <button className="back-arrow" onClick={onBack}>
                            ‚Üê
                        </button>
                        <h1 className="recipe-title-header">{syrup.name}</h1>
                    </div>
                    
                    <div className="recipe-view">
                        {/* UPDATED: Background picture with reduced blur to be more visible */}
                        {syrup.image_url && (
                            <div className="recipe-background" style={backgroundStyle}></div>
                        )}
                        
                        <div className="recipe-content">
                            <div className="recipe-header">
                                <div className="recipe-meta">
                                    <div className="meta-item">{syrup.type}</div>
                                    {syrup.shelf_life && (
                                        <div className="meta-item">Shelf: {syrup.shelf_life}</div>
                                    )}
                                    {syrup.storage && (
                                        <div className="meta-item">Store: {syrup.storage}</div>
                                    )}
                                    {/* ADDED: Cost display for syrups */}
                                    {syrup.cost && (
                                        <div className="meta-item">Cost: ${syrup.cost}</div>
                                    )}
                                </div>
                            </div>
                            
                            <div className="recipe-details-page">
                                <div>
                                    <h3 style={{color: '#FFB366', marginBottom: '1rem', fontSize: '1.1rem'}}>Ingredients</h3>
                                    {syrup.ingredients && syrup.ingredients.length > 0 ? (
                                        <ul className="ingredients-list">
                                            {syrup.ingredients.map((ingredient, index) => (
                                                <li key={index} className="ingredient-item">
                                                    <span>{ingredient.name}</span>
                                                    <span>{ingredient.amount} {ingredient.unit}</span>
                                                </li>
                                            ))}
                                        </ul>
                                    ) : (
                                        <p style={{color: '#888', fontStyle: 'italic'}}>No ingredients specified</p>
                                    )}
                                </div>
                                
                                <div>
                                    <h3 style={{color: '#FFB366', marginBottom: '1rem', fontSize: '1.1rem'}}>Instructions</h3>
                                    <div className="instructions">{syrup.instructions || 'No instructions provided'}</div>
                                    
                                    <div className="action-buttons">
                                        <button className="action-button scale" onClick={() => setShowScaleModal(true)}>
                                            ‚öñÔ∏è Scale
                                        </button>
                                        <button className="action-button share" onClick={handleShareSyrup}>
                                            üì§ Share
                                        </button>
                                        {isAdmin && (
                                            <>
                                                <button 
                                                    className="action-button edit"
                                                    onClick={() => {
                                                        if (onEditSyrup) {
                                                            onEditSyrup(syrup);
                                                        }
                                                    }}
                                                >
                                                    ‚úèÔ∏è Edit
                                                </button>
                                                <button 
                                                    className="action-button delete"
                                                    onClick={() => onDeleteSyrup(syrup.id)}
                                                >
                                                    üóëÔ∏è Delete
                                                </button>
                                            </>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {showScaleModal && (
                        <ScaleRecipeModal 
                            recipe={syrup} 
                            onClose={() => setShowScaleModal(false)} 
                        />
                    )}
                </div>
            );
        }

        // Create/Edit Recipe Component with drag and drop
        function CreateEditRecipePage({ recipe, onBack, onSave, isEdit = false }) {
            const [formData, setFormData] = useState(
                recipe || {
                    name: '',
                    spirit_type: '',
                    venue: '',
                    glass_type: '',
                    abv: '',
                    pour_cost: '',
                    image_url: '',
                    ingredients: [{ name: '', amount: '', unit: 'ml' }],
                    instructions: '',
                    notes: ''
                }
            );
            
            const [imagePreview, setImagePreview] = useState(recipe?.image_url || '');
            const [isDragging, setIsDragging] = useState(false);
            const settings = getSettings();
            
            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: value
                }));
            };
            
            const handleIngredientChange = (index, field, value) => {
                const updatedIngredients = [...formData.ingredients];
                updatedIngredients[index][field] = value;
                setFormData(prev => ({
                    ...prev,
                    ingredients: updatedIngredients
                }));
            };
            
            const addIngredient = () => {
                setFormData(prev => ({
                    ...prev,
                    ingredients: [...prev.ingredients, { name: '', amount: '', unit: 'ml' }]
                }));
            };
            
            const removeIngredient = (index) => {
                if (formData.ingredients.length > 1) {
                    const updatedIngredients = [...formData.ingredients];
                    updatedIngredients.splice(index, 1);
                    setFormData(prev => ({
                        ...prev,
                        ingredients: updatedIngredients
                    }));
                }
            };
            
            const handleImageUpload = async (file) => {
                if (file) {
                    try {
                        const base64 = await convertImageToBase64(file);
                        setFormData(prev => ({
                            ...prev,
                            image_url: base64
                        }));
                        setImagePreview(base64);
                    } catch (error) {
                        console.error('Error uploading image:', error);
                        alert('Error uploading image. Please try again.');
                    }
                }
            };
            
            const handleFileInputChange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    await handleImageUpload(file);
                }
            };
            
            // Drag and drop handlers
            const handleDragOver = (e) => {
                e.preventDefault();
                setIsDragging(true);
            };
            
            const handleDragLeave = (e) => {
                e.preventDefault();
                setIsDragging(false);
            };
            
            const handleDrop = async (e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    await handleImageUpload(files[0]);
                }
            };
            
            const handleSubmit = (e) => {
                e.preventDefault();
                
                if (!formData.name) {
                    alert('Please at least enter a cocktail name');
                    return;
                }
                
                const recipeData = {
                    ...formData,
                    id: isEdit ? formData.id : Date.now().toString(),
                    abv: parseFloat(formData.abv) || 0,
                    pour_cost: parseFloat(formData.pour_cost) || 0,
                    createdBy: isEdit ? formData.createdBy : 'user',
                    createdAt: isEdit ? formData.createdAt : new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                onSave(recipeData);
            };
            
            return (
                <div className="container">
                    <button className="button button-secondary" onClick={onBack}>
                        ‚Üê Back to Cocktails
                    </button>
                    
                    <h1 className="page-title">{isEdit ? 'Edit Cocktail' : 'Add New Cocktail'}</h1>
                    
                    <form className="form" onSubmit={handleSubmit}>
                        <div className="form-group">
                            <label className="form-label">Cocktail Name *</label>
                            <input
                                type="text"
                                className="form-input"
                                name="name"
                                value={formData.name}
                                onChange={handleInputChange}
                                required
                            />
                        </div>
                        
                        <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem'}}>
                            <div className="form-group">
                                <label className="form-label">Spirit Type</label>
                                <select
                                    className="form-input"
                                    name="spirit_type"
                                    value={formData.spirit_type}
                                    onChange={handleInputChange}
                                >
                                    <option value="">Select Spirit</option>
                                    {settings.spirit_types.map(spirit => (
                                        <option key={spirit} value={spirit}>{spirit}</option>
                                    ))}
                                </select>
                            </div>
                            
                            <div className="form-group">
                                <label className="form-label">Venue</label>
                                <select
                                    className="form-input"
                                    name="venue"
                                    value={formData.venue}
                                    onChange={handleInputChange}
                                >
                                    <option value="">Select Venue</option>
                                    {settings.venues.map(venue => (
                                        <option key={venue} value={venue}>{venue}</option>
                                    ))}
                                </select>
                            </div>
                        </div>
                        
                        <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem'}}>
                            <div className="form-group">
                                <label className="form-label">Glass Type</label>
                                <select
                                    className="form-input"
                                    name="glass_type"
                                    value={formData.glass_type}
                                    onChange={handleInputChange}
                                >
                                    <option value="">Select Glass</option>
                                    {settings.glass_types.map(glass => (
                                        <option key={glass} value={glass}>{glass}</option>
                                    ))}
                                </select>
                            </div>
                            
                            <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem'}}>
                                <div className="form-group">
                                    <label className="form-label">ABV (%)</label>
                                    <input
                                        type="number"
                                        step="0.1"
                                        className="form-input"
                                        name="abv"
                                        value={formData.abv}
                                        onChange={handleInputChange}
                                    />
                                </div>
                                
                                <div className="form-group">
                                    <label className="form-label">Pour Cost ($)</label>
                                    <input
                                        type="number"
                                        step="0.01"
                                        className="form-input"
                                        name="pour_cost"
                                        value={formData.pour_cost}
                                        onChange={handleInputChange}
                                    />
                                </div>
                            </div>
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Image</label>
                            <div 
                                className={`drop-zone ${isDragging ? 'dragover' : ''}`}
                                onDragOver={handleDragOver}
                                onDragLeave={handleDragLeave}
                                onDrop={handleDrop}
                                onClick={() => document.getElementById('image-upload').click()}
                            >
                                <div className="drop-zone-text">
                                    {imagePreview ? 'Change Image' : 'Upload Image'}
                                </div>
                                <div className="drop-zone-subtext">
                                    Drag & drop or click to upload
                                </div>
                            </div>
                            
                            <input
                                type="file"
                                id="image-upload"
                                accept="image/*"
                                onChange={handleFileInputChange}
                                style={{display: 'none'}}
                            />
                            
                            {imagePreview && (
                                <div className="image-upload">
                                    <img src={imagePreview} alt="Preview" className="image-preview" />
                                    <button 
                                        type="button" 
                                        className="button button-secondary"
                                        onClick={() => {
                                            setImagePreview('');
                                            setFormData(prev => ({ ...prev, image_url: '' }));
                                        }}
                                    >
                                        Remove Image
                                    </button>
                                </div>
                            )}
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Ingredients</label>
                            {formData.ingredients.map((ingredient, index) => (
                                <div key={index} style={{display: 'grid', gridTemplateColumns: '2fr 1fr 1fr auto', gap: '0.5rem', marginBottom: '0.5rem'}}>
                                    <input
                                        type="text"
                                        className="form-input"
                                        placeholder="Ingredient name"
                                        value={ingredient.name}
                                        onChange={(e) => handleIngredientChange(index, 'name', e.target.value)}
                                    />
                                    <input
                                        type="number"
                                        step="0.1"
                                        className="form-input"
                                        placeholder="Amount"
                                        value={ingredient.amount}
                                        onChange={(e) => handleIngredientChange(index, 'amount', e.target.value)}
                                    />
                                    <select
                                        className="form-input"
                                        value={ingredient.unit}
                                        onChange={(e) => handleIngredientChange(index, 'unit', e.target.value)}
                                    >
                                        <option value="ml">ml</option>
                                        <option value="oz">oz</option>
                                        <option value="dash">dash</option>
                                        <option value="drop">drop</option>
                                        <option value="piece">piece</option>
                                        <option value="slice">slice</option>
                                        <option value="sprig">sprig</option>
                                    </select>
                                    {formData.ingredients.length > 1 && (
                                        <button 
                                            type="button" 
                                            className="button button-secondary"
                                            onClick={() => removeIngredient(index)}
                                            style={{padding: '0.5rem'}}
                                        >
                                            ‚úï
                                        </button>
                                    )}
                                </div>
                            ))}
                            <button type="button" className="button button-secondary" onClick={addIngredient}>
                                + Add Ingredient
                            </button>
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Instructions</label>
                            <textarea
                                className="form-textarea"
                                name="instructions"
                                value={formData.instructions}
                                onChange={handleInputChange}
                                placeholder="Step-by-step instructions..."
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Notes (Optional)</label>
                            <textarea
                                className="form-textarea"
                                name="notes"
                                value={formData.notes}
                                onChange={handleInputChange}
                                placeholder="Additional notes, variations, or tips..."
                            />
                        </div>
                        
                        <div className="buttons-row">
                            <button type="submit" className="button">
                                {isEdit ? 'Update Cocktail' : 'Add Cocktail'}
                            </button>
                            <button type="button" className="button button-secondary" onClick={onBack}>
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            );
        }

        // UPDATED: Create/Edit Syrup Component with cost field
        function CreateEditSyrupPage({ syrup, onBack, onSave, isEdit = false }) {
            const [formData, setFormData] = useState(
                syrup || {
                    name: '',
                    type: 'Syrup',
                    ingredients: [{ name: '', amount: '', unit: 'ml' }],
                    instructions: '',
                    shelf_life: '',
                    storage: '',
                    cost: '', // ADDED: Cost field
                    image_url: ''
                }
            );
            
            const [imagePreview, setImagePreview] = useState(syrup?.image_url || '');
            const [isDragging, setIsDragging] = useState(false);
            
            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: value
                }));
            };
            
            const handleIngredientChange = (index, field, value) => {
                const updatedIngredients = [...formData.ingredients];
                updatedIngredients[index][field] = value;
                setFormData(prev => ({
                    ...prev,
                    ingredients: updatedIngredients
                }));
            };
            
            const addIngredient = () => {
                setFormData(prev => ({
                    ...prev,
                    ingredients: [...prev.ingredients, { name: '', amount: '', unit: 'ml' }]
                }));
            };
            
            const removeIngredient = (index) => {
                if (formData.ingredients.length > 1) {
                    const updatedIngredients = [...formData.ingredients];
                    updatedIngredients.splice(index, 1);
                    setFormData(prev => ({
                        ...prev,
                        ingredients: updatedIngredients
                    }));
                }
            };
            
            const handleImageUpload = async (file) => {
                if (file) {
                    try {
                        const base64 = await convertImageToBase64(file);
                        setFormData(prev => ({
                            ...prev,
                            image_url: base64
                        }));
                        setImagePreview(base64);
                    } catch (error) {
                        console.error('Error uploading image:', error);
                        alert('Error uploading image. Please try again.');
                    }
                }
            };
            
            const handleFileInputChange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    await handleImageUpload(file);
                }
            };
            
            // Drag and drop handlers
            const handleDragOver = (e) => {
                e.preventDefault();
                setIsDragging(true);
            };
            
            const handleDragLeave = (e) => {
                e.preventDefault();
                setIsDragging(false);
            };
            
            const handleDrop = async (e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    await handleImageUpload(files[0]);
                }
            };
            
            const handleSubmit = (e) => {
                e.preventDefault();
                
                if (!formData.name) {
                    alert('Please at least enter a syrup/infusion name');
                    return;
                }
                
                const syrupData = {
                    ...formData,
                    id: isEdit ? formData.id : Date.now().toString(),
                    cost: parseFloat(formData.cost) || 0, // ADDED: Parse cost as float
                    createdBy: isEdit ? formData.createdBy : 'user',
                    createdAt: isEdit ? formData.createdAt : new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                onSave(syrupData);
            };
            
            return (
                <div className="container">
                    <button className="button button-secondary" onClick={onBack}>
                        ‚Üê Back to Syrups
                    </button>
                    
                    <h1 className="page-title">{isEdit ? 'Edit Syrup/Infusion' : 'Add New Syrup/Infusion'}</h1>
                    
                    <form className="form" onSubmit={handleSubmit}>
                        <div className="form-group">
                            <label className="form-label">Name *</label>
                            <input
                                type="text"
                                className="form-input"
                                name="name"
                                value={formData.name}
                                onChange={handleInputChange}
                                required
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Type</label>
                            <select
                                className="form-input"
                                name="type"
                                value={formData.type}
                                onChange={handleInputChange}
                            >
                                <option value="Syrup">Syrup</option>
                                <option value="Infusion">Infusion</option>
                                <option value="Tincture">Tincture</option>
                                <option value="Bitters">Bitters</option>
                                <option value="Cordial">Cordial</option>
                            </select>
                        </div>
                        
                        {/* ADDED: Cost input field for syrups */}
                        <div className="form-group">
                            <label className="form-label">Cost ($)</label>
                            <input
                                type="number"
                                step="0.01"
                                className="form-input"
                                name="cost"
                                value={formData.cost}
                                onChange={handleInputChange}
                                placeholder="0.00"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Image</label>
                            <div 
                                className={`drop-zone ${isDragging ? 'dragover' : ''}`}
                                onDragOver={handleDragOver}
                                onDragLeave={handleDragLeave}
                                onDrop={handleDrop}
                                onClick={() => document.getElementById('image-upload').click()}
                            >
                                <div className="drop-zone-text">
                                    {imagePreview ? 'Change Image' : 'Upload Image'}
                                </div>
                                <div className="drop-zone-subtext">
                                    Drag & drop or click to upload
                                </div>
                            </div>
                            
                            <input
                                type="file"
                                id="image-upload"
                                accept="image/*"
                                onChange={handleFileInputChange}
                                style={{display: 'none'}}
                            />
                            
                            {imagePreview && (
                                <div className="image-upload">
                                    <img src={imagePreview} alt="Preview" className="image-preview" />
                                    <button 
                                        type="button" 
                                        className="button button-secondary"
                                        onClick={() => {
                                            setImagePreview('');
                                            setFormData(prev => ({ ...prev, image_url: '' }));
                                        }}
                                    >
                                        Remove Image
                                    </button>
                                </div>
                            )}
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Ingredients</label>
                            {formData.ingredients.map((ingredient, index) => (
                                <div key={index} style={{display: 'grid', gridTemplateColumns: '2fr 1fr 1fr auto', gap: '0.5rem', marginBottom: '0.5rem'}}>
                                    <input
                                        type="text"
                                        className="form-input"
                                        placeholder="Ingredient name"
                                        value={ingredient.name}
                                        onChange={(e) => handleIngredientChange(index, 'name', e.target.value)}
                                    />
                                    <input
                                        type="number"
                                        step="0.1"
                                        className="form-input"
                                        placeholder="Amount"
                                        value={ingredient.amount}
                                        onChange={(e) => handleIngredientChange(index, 'amount', e.target.value)}
                                    />
                                    <select
                                        className="form-input"
                                        value={ingredient.unit}
                                        onChange={(e) => handleIngredientChange(index, 'unit', e.target.value)}
                                    >
                                        <option value="ml">ml</option>
                                        <option value="oz">oz</option>
                                        <option value="cup">cup</option>
                                        <option value="tsp">tsp</option>
                                        <option value="tbsp">tbsp</option>
                                        <option value="gram">gram</option>
                                        <option value="piece">piece</option>
                                    </select>
                                    {formData.ingredients.length > 1 && (
                                        <button 
                                            type="button" 
                                            className="button button-secondary"
                                            onClick={() => removeIngredient(index)}
                                            style={{padding: '0.5rem'}}
                                        >
                                            ‚úï
                                        </button>
                                    )}
                                </div>
                            ))}
                            <button type="button" className="button button-secondary" onClick={addIngredient}>
                                + Add Ingredient
                            </button>
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Instructions</label>
                            <textarea
                                className="form-textarea"
                                name="instructions"
                                value={formData.instructions}
                                onChange={handleInputChange}
                                placeholder="Step-by-step preparation instructions..."
                            />
                        </div>
                        
                        <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem'}}>
                            <div className="form-group">
                                <label className="form-label">Shelf Life</label>
                                <input
                                    type="text"
                                    className="form-input"
                                    name="shelf_life"
                                    value={formData.shelf_life}
                                    onChange={handleInputChange}
                                    placeholder="e.g., 2 weeks refrigerated"
                                />
                            </div>
                            
                            <div className="form-group">
                                <label className="form-label">Storage</label>
                                <input
                                    type="text"
                                    className="form-input"
                                    name="storage"
                                    value={formData.storage}
                                    onChange={handleInputChange}
                                    placeholder="e.g., Refrigerate in airtight container"
                                />
                            </div>
                        </div>
                        
                        <div className="buttons-row">
                            <button type="submit" className="button">
                                {isEdit ? 'Update Syrup/Infusion' : 'Add Syrup/Infusion'}
                            </button>
                            <button type="button" className="button button-secondary" onClick={onBack}>
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            );
        }

        // Syrups Page Component
        function SyrupsPage({ onSyrupClick, onDeleteSyrup, isAdmin, onCreateSyrup, syrups, onBack }) {
            const [searchTerm, setSearchTerm] = useState('');
            const [filterType, setFilterType] = useState('All');
            
            // Filter syrups based on search and filters
            const filteredSyrups = syrups.filter(syrup => {
                const matchesSearch = syrup.name.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesType = filterType === 'All' || syrup.type === filterType;
                
                return matchesSearch && matchesType;
            });
            
            // Group syrups by first letter
            const groupedSyrups = filteredSyrups.reduce((groups, syrup) => {
                const firstLetter = syrup.name.charAt(0).toUpperCase();
                if (!groups[firstLetter]) {
                    groups[firstLetter] = [];
                }
                groups[firstLetter].push(syrup);
                return groups;
            }, {});
            
            // Sort the groups alphabetically
            const sortedLetters = Object.keys(groupedSyrups).sort();
            
            // Scroll to letter function
            const scrollToLetter = (letter) => {
                const element = document.getElementById(`letter-${letter}`);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            };
            
            return (
                <div className="container">
                    <div className="page-header">
                        <div>
                            <button className="button button-secondary" onClick={onBack} style={{marginBottom: '1rem'}}>
                                ‚Üê Back to Cocktails
                            </button>
                            <h1 className="page-title">Syrups & Infusions</h1>
                        </div>
                        {isAdmin && (
                            <button className="button" onClick={onCreateSyrup}>
                                ‚ûï Add Syrup/Infusion
                            </button>
                        )}
                    </div>
                    
                    <div className="search-section">
                        <input 
                            type="text"
                            className="search-box"
                            placeholder="Search syrups and infusions..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                        />
                        
                        <div className="filters">
                            <select 
                                className="filter-select"
                                value={filterType}
                                onChange={(e) => setFilterType(e.target.value)}
                            >
                                <option value="All">All Types</option>
                                <option value="Syrup">Syrup</option>
                                <option value="Infusion">Infusion</option>
                                <option value="Tincture">Tincture</option>
                                <option value="Bitters">Bitters</option>
                                <option value="Cordial">Cordial</option>
                            </select>
                        </div>
                    </div>
                    
                    <div className="main-content">
                        <div className="recipes-container">
                            {filteredSyrups.length === 0 ? (
                                <div className="loading">
                                    {syrups.length === 0 ? (
                                        'No syrups or infusions available. Login as admin to add some.'
                                    ) : (
                                        'No syrups or infusions found matching your criteria.'
                                    )}
                                </div>
                            ) : (
                                <>
                                    {sortedLetters.map(letter => (
                                        <div key={letter} id={`letter-${letter}`} className="alphabet-section">
                                            <h2 className="letter-header">{letter}</h2>
                                            <div className="recipes-grid">
                                                {groupedSyrups[letter].map(syrup => (
                                                    <SyrupCard 
                                                        key={syrup.id}
                                                        syrup={syrup}
                                                        onClick={onSyrupClick}
                                                        isAdmin={isAdmin}
                                                    />
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </>
                            )}
                        </div>
                        
                        {/* Right-side Alphabet Navigation */}
                        {sortedLetters.length > 0 && (
                            <AlphabetNav letters={sortedLetters} onLetterClick={scrollToLetter} />
                        )}
                    </div>
                </div>
            );
        }

        // UPDATED: Settings Page Component with inline add fields
        function SettingsPage({ onBack, settings, onSaveSettings, isAdmin }) {
            const [formData, setFormData] = useState(settings);
            const [dragIndex, setDragIndex] = useState(null);
            const [newSpirit, setNewSpirit] = useState('');
            const [newGlass, setNewGlass] = useState('');
            const [newVenue, setNewVenue] = useState('');
            
            const handleInputChange = (section, field, value) => {
                setFormData(prev => ({
                    ...prev,
                    [section]: prev[section].map(item => 
                        item === field ? value : item
                    )
                }));
            };
            
            // UPDATED: Add items with inline input fields
            const addSpiritType = () => {
                if (newSpirit && newSpirit.trim()) {
                    setFormData(prev => ({
                        ...prev,
                        spirit_types: [...prev.spirit_types, newSpirit.trim()]
                    }));
                    setNewSpirit('');
                }
            };
            
            const addGlassType = () => {
                if (newGlass && newGlass.trim()) {
                    setFormData(prev => ({
                        ...prev,
                        glass_types: [...prev.glass_types, newGlass.trim()]
                    }));
                    setNewGlass('');
                }
            };
            
            const addVenue = () => {
                if (newVenue && newVenue.trim()) {
                    setFormData(prev => ({
                        ...prev,
                        venues: [...prev.venues, newVenue.trim()]
                    }));
                    setNewVenue('');
                }
            };
            
            const removeItem = (section, index) => {
                if (confirm('Are you sure you want to remove this item?')) {
                    setFormData(prev => ({
                        ...prev,
                        [section]: prev[section].filter((_, i) => i !== index)
                    }));
                }
            };
            
            const handleDragStart = (index) => {
                setDragIndex(index);
            };
            
            const handleDragOver = (e, index) => {
                e.preventDefault();
            };
            
            const handleDrop = (section, dropIndex) => {
                if (dragIndex === null || dragIndex === dropIndex) return;
                
                const reorderedItems = reorder(formData[section], dragIndex, dropIndex);
                setFormData(prev => ({
                    ...prev,
                    [section]: reorderedItems
                }));
                setDragIndex(null);
            };
            
            const handleSubmit = (e) => {
                e.preventDefault();
                onSaveSettings(formData);
                onBack();
            };
            
            if (!isAdmin) {
                return (
                    <div className="container">
                        <button className="button button-secondary" onClick={onBack}>
                            ‚Üê Back
                        </button>
                        <div className="loading">
                            Admin access required to modify settings.
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="container">
                    <button className="button button-secondary" onClick={onBack}>
                        ‚Üê Back
                    </button>
                    
                    <h1 className="page-title">Settings</h1>
                    
                    <form className="form" onSubmit={handleSubmit}>
                        <div className="settings-section">
                            <h2 className="settings-title">Spirit Types</h2>
                            
                            {/* UPDATED: Inline add form for spirit types */}
                            <div className="add-item-form">
                                <input
                                    type="text"
                                    className="add-item-input"
                                    placeholder="Enter new spirit type"
                                    value={newSpirit}
                                    onChange={(e) => setNewSpirit(e.target.value)}
                                />
                                <button 
                                    type="button" 
                                    className="add-item-btn"
                                    onClick={addSpiritType}
                                >
                                    Add Spirit Type
                                </button>
                            </div>
                            
                            <ul className="settings-list">
                                {formData.spirit_types.map((spirit, index) => (
                                    <li 
                                        key={index}
                                        className={`settings-item ${dragIndex === index ? 'dragging' : ''}`}
                                        draggable
                                        onDragStart={() => handleDragStart(index)}
                                        onDragOver={(e) => handleDragOver(e, index)}
                                        onDrop={() => handleDrop('spirit_types', index)}
                                    >
                                        <span className="drag-handle">‚ãÆ‚ãÆ</span>
                                        <input
                                            type="text"
                                            className="form-input"
                                            value={spirit}
                                            onChange={(e) => handleInputChange('spirit_types', spirit, e.target.value)}
                                            style={{flex: 1, marginRight: '1rem'}}
                                        />
                                        <div className="settings-actions">
                                            <button 
                                                type="button" 
                                                className="icon-button delete"
                                                onClick={() => removeItem('spirit_types', index)}
                                            >
                                                ‚úï
                                            </button>
                                        </div>
                                    </li>
                                ))}
                            </ul>
                        </div>
                        
                        <div className="settings-section">
                            <h2 className="settings-title">Glass Types</h2>
                            
                            {/* UPDATED: Inline add form for glass types */}
                            <div className="add-item-form">
                                <input
                                    type="text"
                                    className="add-item-input"
                                    placeholder="Enter new glass type"
                                    value={newGlass}
                                    onChange={(e) => setNewGlass(e.target.value)}
                                />
                                <button 
                                    type="button" 
                                    className="add-item-btn"
                                    onClick={addGlassType}
                                >
                                    Add Glass Type
                                </button>
                            </div>
                            
                            <ul className="settings-list">
                                {formData.glass_types.map((glass, index) => (
                                    <li 
                                        key={index}
                                        className={`settings-item ${dragIndex === index ? 'dragging' : ''}`}
                                        draggable
                                        onDragStart={() => handleDragStart(index)}
                                        onDragOver={(e) => handleDragOver(e, index)}
                                        onDrop={() => handleDrop('glass_types', index)}
                                    >
                                        <span className="drag-handle">‚ãÆ‚ãÆ</span>
                                        <input
                                            type="text"
                                            className="form-input"
                                            value={glass}
                                            onChange={(e) => handleInputChange('glass_types', glass, e.target.value)}
                                            style={{flex: 1, marginRight: '1rem'}}
                                        />
                                        <div className="settings-actions">
                                            <button 
                                                type="button" 
                                                className="icon-button delete"
                                                onClick={() => removeItem('glass_types', index)}
                                            >
                                                ‚úï
                                            </button>
                                        </div>
                                    </li>
                                ))}
                            </ul>
                        </div>
                        
                        <div className="settings-section">
                            <h2 className="settings-title">Venues</h2>
                            
                            {/* UPDATED: Inline add form for venues */}
                            <div className="add-item-form">
                                <input
                                    type="text"
                                    className="add-item-input"
                                    placeholder="Enter new venue"
                                    value={newVenue}
                                    onChange={(e) => setNewVenue(e.target.value)}
                                />
                                <button 
                                    type="button" 
                                    className="add-item-btn"
                                    onClick={addVenue}
                                >
                                    Add Venue
                                </button>
                            </div>
                            
                            <ul className="settings-list">
                                {formData.venues.map((venue, index) => (
                                    <li 
                                        key={index}
                                        className={`settings-item ${dragIndex === index ? 'dragging' : ''}`}
                                        draggable
                                        onDragStart={() => handleDragStart(index)}
                                        onDragOver={(e) => handleDragOver(e, index)}
                                        onDrop={() => handleDrop('venues', index)}
                                    >
                                        <span className="drag-handle">‚ãÆ‚ãÆ</span>
                                        <input
                                            type="text"
                                            className="form-input"
                                            value={venue}
                                            onChange={(e) => handleInputChange('venues', venue, e.target.value)}
                                            style={{flex: 1, marginRight: '1rem'}}
                                        />
                                        <div className="settings-actions">
                                            <button 
                                                type="button" 
                                                className="icon-button delete"
                                                onClick={() => removeItem('venues', index)}
                                            >
                                                ‚úï
                                            </button>
                                        </div>
                                    </li>
                                ))}
                            </ul>
                        </div>
                        
                        <div className="buttons-row">
                            <button type="submit" className="button">
                                Save Settings
                            </button>
                            <button type="button" className="button button-secondary" onClick={onBack}>
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            );
        }

        // Login Component
        function LoginPage({ onLogin, onLoginAsGuest }) {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                
                const success = await onLogin(username, password);
                if (!success) {
                    setError('Invalid credentials');
                }
            };
            
            return (
                <div className="container" style={{maxWidth: '400px', textAlign: 'center', paddingTop: '4rem'}}>
                    <div style={{fontSize: '4rem', marginBottom: '1rem'}}>üêë</div>
                    <h1 style={{color: '#FFB366', marginBottom: '2rem'}}>Cocktail Codex</h1>
                    
                    <form className="form" onSubmit={handleSubmit}>
                        {error && (
                            <div style={{color: '#f44336', marginBottom: '1rem', padding: '0.5rem', background: 'rgba(244, 67, 54, 0.1)', borderRadius: '4px'}}>
                                {error}
                            </div>
                        )}
                        
                        <div className="form-group">
                            <input
                                type="text"
                                className="form-input"
                                placeholder="Username"
                                value={username}
                                onChange={(e) => setUsername(e.target.value)}
                                required
                            />
                        </div>
                        
                        <div className="form-group">
                            <input
                                type="password"
                                className="form-input"
                                placeholder="Password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                required
                            />
                        </div>
                        
                        <button type="submit" className="button" style={{width: '100%', marginBottom: '1rem'}}>
                            Login as Admin
                        </button>
                    </form>
                    
                    <div style={{margin: '2rem 0', color: '#888'}}>or</div>
                    
                    <button 
                        className="button button-secondary" 
                        onClick={onLoginAsGuest}
                        style={{width: '100%'}}
                    >
                        Continue as Guest
                    </button>
                    
                    <div style={{marginTop: '3rem', color: '#888', fontSize: '0.9rem'}}>
                        <p>Admin access allows you to:</p>
                        <ul style={{textAlign: 'left', marginTop: '0.5rem'}}>
                            <li>Add/edit/delete cocktails</li>
                            <li>Manage syrups & infusions</li>
                            <li>Modify app settings</li>
                        </ul>
                    </div>
                </div>
            );
        }

        // Main App Component
        function App() {
            const { user, firebaseUser, login, loginAsGuest, logout } = useAuth();
            const [currentPage, setCurrentPage] = useState('home');
            const [selectedRecipe, setSelectedRecipe] = useState(null);
            const [selectedSyrup, setSelectedSyrup] = useState(null);
            const [editingRecipe, setEditingRecipe] = useState(null);
            const [editingSyrup, setEditingSyrup] = useState(null);
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const [recipes, setRecipes] = useState([]);
            const [syrups, setSyrups] = useState([]);
            const [settings, setSettings] = useState(getSettings());
            const [syncStatus, setSyncStatus] = useState('synced'); // 'synced', 'syncing', 'error'
            
            // Load initial data
            useEffect(() => {
                const loadInitialData = async () => {
                    console.log('Loading initial data...');
                    
                    // Load from localStorage first for immediate display
                    const localRecipes = getRecipes();
                    const localSyrups = getSyrups();
                    const localSettings = getSettings();
                    
                    setRecipes(localRecipes);
                    setSyrups(localSyrups);
                    setSettings(localSettings);
                    
                    console.log('Local data loaded:', {
                        recipes: localRecipes.length,
                        syrups: localSyrups.length
                    });
                    
                    // Then try to load from Firebase
                    try {
                        setSyncStatus('syncing');
                        
                        const [firebaseRecipes, firebaseSyrups, firebaseSettings] = await Promise.all([
                            loadRecipesFromFirebase(),
                            loadSyrupsFromFirebase(),
                            loadSettingsFromFirebase()
                        ]);
                        
                        // Use Firebase data if available and newer
                        if (firebaseRecipes !== null) {
                            setRecipes(firebaseRecipes);
                            saveRecipes(firebaseRecipes);
                        }
                        
                        if (firebaseSyrups !== null) {
                            setSyrups(firebaseSyrups);
                            saveSyrups(firebaseSyrups);
                        }
                        
                        if (firebaseSettings !== null) {
                            setSettings(firebaseSettings);
                            saveSettings(firebaseSettings);
                        }
                        
                        setSyncStatus('synced');
                        console.log('Firebase data loaded successfully');
                    } catch (error) {
                        console.error('Error loading from Firebase:', error);
                        setSyncStatus('error');
                    }
                };
                
                loadInitialData();
            }, []);
            
            // Set up Firebase real-time listeners
            useEffect(() => {
                if (!firebaseUser) return;
                
                console.log('Setting up Firebase listeners for user:', firebaseUser.uid);
                
                const cleanup = setupFirebaseListeners(
                    (newRecipes) => {
                        console.log('Recipes updated from cloud:', newRecipes.length);
                        setRecipes(newRecipes);
                        saveRecipes(newRecipes);
                    },
                    (newSyrups) => {
                        console.log('Syrups updated from cloud:', newSyrups.length);
                        setSyrups(newSyrups);
                        saveSyrups(newSyrups);
                    },
                    (newSettings) => {
                        console.log('Settings updated from cloud');
                        setSettings(newSettings);
                        saveSettings(newSettings);
                    }
                );
                
                return cleanup;
            }, [firebaseUser]);
            
            // Manual sync function
            const handleManualSync = async () => {
                setSyncStatus('syncing');
                
                try {
                    const [recipesSuccess, syrupsSuccess, settingsSuccess] = await Promise.all([
                        syncRecipesWithFirebase(recipes),
                        syncSyrupsWithFirebase(syrups),
                        syncSettingsWithFirebase(settings)
                    ]);
                    
                    if (recipesSuccess && syrupsSuccess && settingsSuccess) {
                        setSyncStatus('synced');
                        console.log('Manual sync completed successfully');
                    } else {
                        setSyncStatus('error');
                        console.error('Manual sync partially failed');
                    }
                } catch (error) {
                    console.error('Manual sync error:', error);
                    setSyncStatus('error');
                }
            };
            
            // Navigation handlers
            const navigateTo = (page) => {
                setCurrentPage(page);
                setSelectedRecipe(null);
                setSelectedSyrup(null);
                setEditingRecipe(null);
                setEditingSyrup(null);
            };
            
            const handleRecipeClick = (recipe) => {
                setSelectedRecipe(recipe);
                setCurrentPage('view-recipe');
            };
            
            const handleSyrupClick = (syrup) => {
                setSelectedSyrup(syrup);
                setCurrentPage('view-syrup');
            };
            
            const handleEditRecipe = (recipe) => {
                setEditingRecipe(recipe);
                setCurrentPage('edit-recipe');
            };
            
            const handleEditSyrup = (syrup) => {
                setEditingSyrup(syrup);
                setCurrentPage('edit-syrup');
            };
            
            // Data management handlers
            const handleSaveRecipe = async (recipeData) => {
                let updatedRecipes;
                
                if (editingRecipe) {
                    // Update existing recipe
                    updatedRecipes = recipes.map(recipe => 
                        recipe.id === recipeData.id ? recipeData : recipe
                    );
                } else {
                    // Add new recipe
                    updatedRecipes = [...recipes, recipeData];
                }
                
                setRecipes(updatedRecipes);
                saveRecipes(updatedRecipes);
                
                // Sync to Firebase
                try {
                    await syncRecipesWithFirebase(updatedRecipes);
                } catch (error) {
                    console.error('Error syncing recipe to Firebase:', error);
                }
                
                navigateTo('home');
            };
            
            const handleSaveSyrup = async (syrupData) => {
                let updatedSyrups;
                
                if (editingSyrup) {
                    // Update existing syrup
                    updatedSyrups = syrups.map(syrup => 
                        syrup.id === syrupData.id ? syrupData : syrup
                    );
                } else {
                    // Add new syrup
                    updatedSyrups = [...syrups, syrupData];
                }
                
                setSyrups(updatedSyrups);
                saveSyrups(updatedSyrups);
                
                // Sync to Firebase
                try {
                    await syncSyrupsWithFirebase(updatedSyrups);
                } catch (error) {
                    console.error('Error syncing syrup to Firebase:', error);
                }
                
                navigateTo('syrups');
            };
            
            // FIXED: Remove confirmation dialog for deletions
            const handleDeleteRecipe = async (recipeId) => {
                const updatedRecipes = recipes.filter(recipe => recipe.id !== recipeId);
                setRecipes(updatedRecipes);
                saveRecipes(updatedRecipes);
                
                // Sync to Firebase
                try {
                    await syncRecipesWithFirebase(updatedRecipes);
                } catch (error) {
                    console.error('Error syncing after delete to Firebase:', error);
                }
                
                // Automatically return to main page after deleting
                navigateTo('home');
            };
            
            // FIXED: Remove confirmation dialog for deletions
            const handleDeleteSyrup = async (syrupId) => {
                const updatedSyrups = syrups.filter(syrup => syrup.id !== syrupId);
                setSyrups(updatedSyrups);
                saveSyrups(updatedSyrups);
                
                // Sync to Firebase
                try {
                    await syncSyrupsWithFirebase(updatedSyrups);
                } catch (error) {
                    console.error('Error syncing after delete to Firebase:', error);
                }
                
                // Automatically return to syrups page after deleting
                navigateTo('syrups');
            };
            
            const handleSaveSettings = async (newSettings) => {
                setSettings(newSettings);
                saveSettings(newSettings);
                
                // Sync to Firebase
                try {
                    await syncSettingsWithFirebase(newSettings);
                } catch (error) {
                    console.error('Error syncing settings to Firebase:', error);
                }
            };
            
            // Render current page
            const renderCurrentPage = () => {
                if (!user) {
                    return (
                        <LoginPage 
                            onLogin={login}
                            onLoginAsGuest={loginAsGuest}
                        />
                    );
                }
                
                switch (currentPage) {
                    case 'home':
                        return (
                            <HomePage 
                                onRecipeClick={handleRecipeClick}
                                onDeleteRecipe={handleDeleteRecipe}
                                isAdmin={user.isAdmin}
                                onCreateRecipe={() => setCurrentPage('create-recipe')}
                                recipes={recipes}
                                syncStatus={syncStatus}
                                onManualSync={handleManualSync}
                            />
                        );
                    
                    case 'view-recipe':
                        return (
                            <ViewRecipePage 
                                recipe={selectedRecipe}
                                onBack={() => navigateTo('home')}
                                isAdmin={user.isAdmin}
                                onDeleteRecipe={handleDeleteRecipe}
                                onEditRecipe={handleEditRecipe}
                            />
                        );
                    
                    case 'view-syrup':
                        return (
                            <ViewSyrupPage 
                                syrup={selectedSyrup}
                                onBack={() => navigateTo('syrups')}
                                isAdmin={user.isAdmin}
                                onDeleteSyrup={handleDeleteSyrup}
                                onEditSyrup={handleEditSyrup}
                            />
                        );
                    
                    case 'create-recipe':
                        return (
                            <CreateEditRecipePage 
                                onBack={() => navigateTo('home')}
                                onSave={handleSaveRecipe}
                            />
                        );
                    
                    case 'edit-recipe':
                        return (
                            <CreateEditRecipePage 
                                recipe={editingRecipe}
                                onBack={() => navigateTo('home')}
                                onSave={handleSaveRecipe}
                                isEdit={true}
                            />
                        );
                    
                    case 'syrups':
                        return (
                            <SyrupsPage 
                                onSyrupClick={handleSyrupClick}
                                onDeleteSyrup={handleDeleteSyrup}
                                isAdmin={user.isAdmin}
                                onCreateSyrup={() => setCurrentPage('create-syrup')}
                                syrups={syrups}
                                onBack={() => navigateTo('home')}
                            />
                        );
                    
                    case 'create-syrup':
                        return (
                            <CreateEditSyrupPage 
                                onBack={() => navigateTo('syrups')}
                                onSave={handleSaveSyrup}
                            />
                        );
                    
                    case 'edit-syrup':
                        return (
                            <CreateEditSyrupPage 
                                syrup={editingSyrup}
                                onBack={() => navigateTo('syrups')}
                                onSave={handleSaveSyrup}
                                isEdit={true}
                            />
                        );
                    
                    case 'settings':
                        return (
                            <SettingsPage 
                                onBack={() => navigateTo('home')}
                                settings={settings}
                                onSaveSettings={handleSaveSettings}
                                isAdmin={user.isAdmin}
                            />
                        );
                    
                    default:
                        return (
                            <HomePage 
                                onRecipeClick={handleRecipeClick}
                                onDeleteRecipe={handleDeleteRecipe}
                                isAdmin={user.isAdmin}
                                onCreateRecipe={() => setCurrentPage('create-recipe')}
                                recipes={recipes}
                                syncStatus={syncStatus}
                                onManualSync={handleManualSync}
                            />
                        );
                }
            };
            
            if (!user) {
                return renderCurrentPage();
            }
            
            return (
                <div>
                    {/* UPDATED: Header with all buttons in single row */}
                    <header className="header">
                        <div style={{display: 'flex', alignItems: 'center', gap: '1rem', width: '100%'}}>
                            <button 
                                className="menu-button"
                                onClick={() => setIsMenuOpen(!isMenuOpen)}
                            >
                                <span className="menu-line"></span>
                                <span className="menu-line"></span>
                                <span className="menu-line"></span>
                            </button>
                            
                            <div className="nav-user" style={{display: 'flex', alignItems: 'center', gap: '0.75rem', marginLeft: 'auto'}}>
                                <div className="sync-status">
                                    <div className={`sync-indicator ${syncStatus}`}></div>
                                    <span>
                                        {syncStatus === 'synced' && 'Synced'}
                                        {syncStatus === 'syncing' && 'Syncing...'}
                                        {syncStatus === 'error' && 'Offline'}
                                    </span>
                                    <button 
                                        className={`sync-btn ${syncStatus === 'syncing' ? 'syncing' : ''}`}
                                        onClick={handleManualSync}
                                        disabled={syncStatus === 'syncing'}
                                    >
                                        üîÑ
                                    </button>
                                </div>
                                
                                {/* UPDATED: All buttons in single row */}
                                <div className="nav-buttons" style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                    {user.isAdmin && (
                                        <button 
                                            className="add-recipe-btn"
                                            onClick={() => setCurrentPage('create-recipe')}
                                        >
                                            ‚ûï Add Recipe
                                        </button>
                                    )}
                                    <button className="logout-btn" onClick={logout}>
                                        Logout
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>
                    
                    <HamburgerMenu 
                        isOpen={isMenuOpen}
                        onToggle={setIsMenuOpen}
                        currentPage={currentPage}
                        onNavigate={navigateTo}
                        isAdmin={user.isAdmin}
                    />
                    
                    {renderCurrentPage()}
                    
                    <footer className="footer">
                        <p>Cocktail Codex ¬© 2025 </p>
                       
<a href="https://www.instagram.com/suraj.gg87/" target="_blank">@suraj.gg87</a>
                    </footer>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
